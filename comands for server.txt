node -v версия локальная

# в этой команде замените 11 на ту мажорную
# версию Node, которая стоит у вас локально
curl -sL https://deb.nodesource.com/setup_11.x | sudo -E bash -

# устанавливаем Node.js
sudo apt-get install -y nodejs

# 1.
wget -qO - https://www.mongodb.org/static/pgp/server-4.2.asc | sudo apt-key add -

# 2.
echo "deb [ arch=amd64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.2.list

# 3.
sudo apt-get update

# 4.
sudo apt-get install -y mongodb-org

sudo service mongod start

mongo

# 1.
sudo apt update

# 2.
sudo apt install git

After this operation, 76.2 MB of additional disk space will be used
Do you want to continue? [Y/n]

git --version

git clone https://github.com/MaximMaslovVik/15_sprint.git

npm install

npm start

sudo npm install pm2 -g

pm2 start app.js

pm2 startup

sudo env PATH=$PATH:/usr/bin /usr/lib/node_modules/pm2/bin/pm2 startup systemd -u praktikum --hp /home/max

pm2 save

sudo node app.js

sudo apt-get update
sudo apt-get install nginx

sudo ufw allow 'Nginx Full'
sudo ufw allow OpenSSH

sudo ufw enable

sudo systemctl start nginx

sudo nano /etc/nginx/sites-enabled/default

# sudo значит запустить команду как суперпользователь
# nano — это текстовый редактор
# /etc/nginx/sites-enabled/default — путь к конфигурационному файлу nginx

server {
        listen 80;

        server_name max-mesto.ml www.max-mesto.ml;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}

Ctrl+X

sudo systemctl restart nginx

sudo apt-get update
sudo apt-get install software-properties-common
sudo add-apt-repository universe
sudo add-apt-repository ppa:certbot/certbot
sudo apt-get update
sudo apt-get install certbot python-certbot-nginx

sudo certbot --nginx

sudo systemctl restart nginx

sudo certbot renew --pre-hook "service nginx stop" --post-hook "service nginx start"

git pull origin master

pm2 restart app

scp -r ./dist/* praktikum@84.201.172.240:/home/praktikum/news-frontend

"deploy": "npm run build && scp -r ./dist/* praktikum@84.201.172.240:/home/praktikum/news-frontend"

sudo nano /etc/nginx/sites-enabled/default

server {
    listen 80;

    server_name max-mesto.ml www.max-mesto.ml
;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/mestoapp.gq/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/mestoapp.gq/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}

server {
    listen 80;

    server_name max-mesto.ml www.max-mesto.ml;


    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/mestoapp.gq/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/mestoapp.gq/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}

sudo systemctl restart nginx

